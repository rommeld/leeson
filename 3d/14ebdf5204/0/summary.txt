All passing. Replaced `Mutex<u128>` with lock-free `AtomicU64` using compare-exchange for the monotonic nonce guarantee.